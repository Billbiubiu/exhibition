(this.webpackJsonpexhibition=this.webpackJsonpexhibition||[]).push([[0],{67:function(t,e,i){},82:function(t,e,i){"use strict";i.r(e);var n=i(0),o=i.n(n),r=i(29),a=i.n(r),s=(i(66),i(67),i(26)),h=i(18),c=i(13),p=i(1),d=i(11),u=i(8),w=function(t){var e=t%(2*Math.PI);return e<0?e+2*Math.PI:e},l=function(t,e){var i=w(t),n=w(e)-i;return n>Math.PI?t-(2*Math.PI-n):n<-Math.PI?t+(2*Math.PI+n):t+n},f=i(86),v=i(87),x=i(10),b=Math.PI,g=b/2,y=2*b,j=window.navigator.userAgent.toLowerCase().indexOf("mobile")>-1,m=new Set,z=function(t,e){var i=t.camera,n=t.renderer.domElement,o=function(t,n,o){var r=i.position.x+t,a=i.position.y+n;(function(t){var i=e.current;return!!i.length&&!!i.find((function(e){return d.booleanPointInPolygon(d.point(t),e)}))})([r,a])&&(i.position.x=r,i.position.y=a,o&&requestAnimationFrame(o))};j?n.addEventListener("touchstart",(function(t){var e=t.touches;if(1===e.length){var o=n.offsetWidth,r=n.offsetHeight,a=i.rotation,s=a.x,h=a.y,c=e[0],p=c.clientX,d=c.clientY,u=function(t){var e=t.touches;if(1===e.length){var n=e[0],a=n.clientX,c=n.clientY,u=s+(c-d)/(r/2)*b;i.rotation.x=u,i.rotation.x=s;var w=h+(a-p)/(o/2)*(2*b);i.rotation.y=w}};n.addEventListener("touchmove",u),n.addEventListener("touchend",(function t(){n.removeEventListener("touchmove",u),n.removeEventListener("touchend",t)}))}else if(2===e.length){var w=i.position,l=w.x,f=w.y,v=Math.sqrt(Math.pow(e[0].clientX-e[1].clientX,2)+Math.pow(e[0].clientY-e[1].clientY,2)),x=function(t){var e=t.touches;if(2===e.length){var n=Math.sqrt(Math.pow(e[0].clientX-e[1].clientX,2)+Math.pow(e[0].clientY-e[1].clientY,2))/v,o=i.rotation.y;if(n<1){var r=10*Math.sin(o),a=10*-Math.cos(o);i.position.x=l+r*(1/n),i.position.y=f+a*(1/n)}else{var s=10*-Math.sin(o),h=10*Math.cos(o);i.position.x=l+s*n,i.position.y=f+h*n}}};n.addEventListener("touchmove",x),n.addEventListener("touchend",(function t(){n.removeEventListener("touchmove",x),n.removeEventListener("touchend",t)}))}})):(n.addEventListener("pointerdown",(function(t){var e=n.offsetWidth,o=n.offsetHeight,r=i.rotation,a=r.x,s=r.y,h=t.offsetX,c=t.offsetY,p=function(t){var n=t.offsetX,r=t.offsetY,p=a+(r-c)/(o/2)*b;i.rotation.x=p,i.rotation.x=a;var d=s+(n-h)/(e/2)*(2*b);i.rotation.y=d};n.addEventListener("pointermove",p),n.addEventListener("pointerup",(function t(){n.removeEventListener("pointermove",p),n.removeEventListener("pointerup",t)}))})),n.addEventListener("wheel",(function(t){var e=t.deltaY,n=i.rotation.y;if(e>0){var r=Math.sin(n),a=-Math.cos(n);o(r,a)}else{var s=-Math.sin(n),h=Math.cos(n);o(s,h)}})),function(){var t={w:"ArrowUp",a:"ArrowLeft",s:"ArrowDown",d:"ArrowRight"},e=function t(){if(m.has("ArrowUp")){var e=i.rotation.y,n=-Math.sin(e),r=Math.cos(e);o(n,r,t)}},n=function t(){if(m.has("ArrowRight"))if(m.has("Control"))i.rotation.y-=b/180,requestAnimationFrame(t);else{var e=i.rotation.y,n=Math.cos(e),r=Math.sin(e);o(n,r,t)}},r=function t(){if(m.has("ArrowDown")){var e=i.rotation.y,n=Math.sin(e),r=-Math.cos(e);o(n,r,t)}},a=function t(){if(m.has("ArrowLeft"))if(m.has("Control"))i.rotation.y+=b/180,requestAnimationFrame(t);else{var e=i.rotation.y,n=-Math.cos(e),r=-Math.sin(e);o(n,r,t)}};document.addEventListener("keydown",(function(i){var o=i.key;if(o=t[o]||o,!m.has(o))switch(m.add(o),o){case"Control":m.add("Control");break;case"ArrowUp":m.delete("ArrowDown"),e();break;case"ArrowRight":m.delete("ArrowLeft"),n();break;case"ArrowDown":m.delete("ArrowUp"),r();break;case"ArrowLeft":m.delete("ArrowRight"),a()}})),document.addEventListener("keyup",(function(e){var i=e.key;i=t[i]||i,m.delete(i)}))}())},M={1:function(t){t.scene;var e=t.camera,i=t.setLoading,n=t.setCurrentExhibit,o=function(t){var i=t.url,o=t.rotation;return new Promise((function(t,r){var a=new Image;a.src=i,a.onload=function(){var r=a.width,s=a.height,h=r/16,c=s/9,d=Math.max(h,c),f=r/d,v=s/d,x=(new p.p).load(i),j=new p.d(f,v,.2),m=[new p.i({color:16777215}),new p.i({color:16777215}),new p.i({color:16777215}),new p.i({color:16777215}),new p.i({map:x}),new p.i({color:16777215})],z=new p.h(j,m);z.position.y=-.2,z.rotation.x=g,z.onClick=function(t){var r=new p.c;r.setFromObject(t.object);var a=r.min,s=r.max,h=a.x+(s.x-a.x)/2,c=a.y+(s.y-a.y)/2,d=(a.z,s.z,a.z,w(o.z)),f={y:l(e.rotation.y,d)};if(Math.sqrt(Math.pow(e.position.x-h,2)+Math.pow(e.position.y-c,2))<=25&&Math.abs(w(e.rotation.y)-d)<b/6)n(i);else{var v={x:h-20*Math.sin(y-d),y:c-20*Math.cos(y-d)},x=10*Math.sqrt(Math.pow(e.position.x-v.x,2)+Math.pow(e.position.y-v.y,2));new u.a.Tween(e).to({position:v,rotation:f},x).interpolation(u.a.Interpolation.Bezier).easing(u.a.Easing.Linear.None).start()}};var M=function(t){var e=t.size,i=e.width,n=e.height,o=new p.o,r=.4;o.moveTo(-.4,-.4),o.lineTo(-.4,n+r),o.lineTo(i+r,n+r),o.lineTo(i+r,-.4);var a=new p.j;a.moveTo(0,0),a.lineTo(0,n),a.lineTo(i,n),a.lineTo(i,0),o.holes.push(a);var s={depth:r,bevelEnabled:!0,bevelSegments:2,steps:2,bevelSize:0,bevelThickness:0},h=new p.e(o,s),c=new p.i({color:15658734}),d=new p.h(h,c);return d.position.x=-i/2,d.position.z=-n/2,d.rotation.x=g,d}({size:{width:f,height:v}}),O=new p.g;O.add(z,M),t(O)},a.onerror=function(){return r()}}))},r=function(t){var e=t.size,n=t.position,r=t.rotation,a=t.exhibits,s=e.width,h=e.height,c=e.depth,d=new p.d(s,h,c),u=new p.i({color:14540253}),w=new p.h(d,u);w.position.y=c/2,w.position.z=h/2,w.rotation.x=-g;var l=new p.h(new p.d(s+.2,c+.2,1),new p.i({color:6710886}));l.position.y=c/2,l.position.z=.5;var f=new p.g;f.add(w,l),Object.assign(f.position,n),Object.assign(f.rotation,r);var v=s/a.length,x=v/2;return Promise.all(a.map((function(t,e){return o({url:t,rotation:r}).then((function(t){t.position.set(-s/2+x+v*e,0,12),f.add(t)}))}))).finally((function(){i(!1)})),f},a=function(){var t=[new p.l(16777215,1,80),new p.l(16777215,1,80)];return t[0].position.set(0,25,19),t[1].position.set(0,-25,19),t}(),s=function(){var t=new p.d(100,100,1),i=new p.i({color:3355443}),n=new p.h(t,i);n.position.z=-.5;var o=d.polygon([[[-49,-49],[49,-49],[49,49],[-49,49],[-49,-49]]]);return n.onClick=function(t){var i=t.point,n=i.x,r=i.y;if(d.booleanPointInPolygon(d.point([n,r]),o)){var a=10*Math.sqrt(Math.pow(e.position.x-n,2)+Math.pow(e.position.y-r,2));new u.a.Tween(e.position).to({x:n,y:r},a).interpolation(u.a.Interpolation.Bezier).easing(u.a.Easing.Linear.None).start()}},n}(),c=function(){var t=new p.d(100,100,1),e=new p.i({color:16777215}),i=new p.h(t,e);return i.position.z=20.5,i}(),f=[{size:{width:100,height:20,depth:1},position:{x:0,y:50,z:0},rotation:{x:0,y:0,z:0},exhibits:["./exhibits/1-1.jpg","./exhibits/1-2.jpg","./exhibits/1-3.jpg","./exhibits/1-4.jpg","./exhibits/1-5.jpg"]},{size:{width:100,height:20,depth:1},position:{x:0,y:-50,z:0},rotation:{x:0,y:0,z:b},exhibits:["./exhibits/2-1.jpg","./exhibits/2-2.jpg","./exhibits/2-3.jpg","./exhibits/2-4.jpg","./exhibits/2-5.jpg"]},{size:{width:100,height:20,depth:1},position:{x:-50,y:0,z:0},rotation:{x:0,y:0,z:g},exhibits:["./exhibits/3-1.jpg","./exhibits/3-2.jpg","./exhibits/3-3.jpg","./exhibits/3-4.jpg","./exhibits/3-5.jpg"]},{size:{width:100,height:20,depth:1},position:{x:50,y:0,z:0},rotation:{x:0,y:0,z:-g},exhibits:["./exhibits/4-1.jpg","./exhibits/4-2.jpg","./exhibits/4-3.jpg","./exhibits/4-4.jpg","./exhibits/4-5.jpg"]}].map(r);return e.position.set(0,-30,12),e.rotation.set(g,0,0),{geometries:[].concat(Object(h.a)(a),[s,c],Object(h.a)(f)),boundaries:[d.polygon([[[-49,-49],[49,-49],[49,49],[-49,49],[-49,-49]]])]}},2:function(t){t.scene;var e=t.camera,i=t.setLoading,n=t.setCurrentExhibit,o=function(t){var i=t.url,o=t.rotation;return new Promise((function(t,r){var a=new Image;a.src=i,a.onload=function(){var r=a.width,s=a.height,h=r/16,c=s/9,d=Math.max(h,c),f=r/d,v=s/d,x=(new p.p).load(i),j=new p.d(f,v,.2),m=[new p.i({color:16777215}),new p.i({color:16777215}),new p.i({color:16777215}),new p.i({color:16777215}),new p.i({map:x}),new p.i({color:16777215})],z=new p.h(j,m);z.position.y=-.2,z.rotation.x=g,z.onClick=function(t){var r=new p.c;r.setFromObject(t.object);var a=r.min,s=r.max,h=a.x+(s.x-a.x)/2,c=a.y+(s.y-a.y)/2,d=(a.z,s.z,a.z,w(o.z)),f={y:l(e.rotation.y,d)};if(Math.sqrt(Math.pow(e.position.x-h,2)+Math.pow(e.position.y-c,2))<=25&&Math.abs(w(e.rotation.y)-d)<b/6)n(i);else{var v={x:h-20*Math.sin(y-d),y:c-20*Math.cos(y-d)},x=10*Math.sqrt(Math.pow(e.position.x-v.x,2)+Math.pow(e.position.y-v.y,2));new u.a.Tween(e).to({position:v,rotation:f},x).interpolation(u.a.Interpolation.Bezier).easing(u.a.Easing.Linear.None).start()}};var M=function(t){var e=t.size,i=e.width,n=e.height,o=new p.o,r=.4;o.moveTo(-.4,-.4),o.lineTo(-.4,n+r),o.lineTo(i+r,n+r),o.lineTo(i+r,-.4);var a=new p.j;a.moveTo(0,0),a.lineTo(0,n),a.lineTo(i,n),a.lineTo(i,0),o.holes.push(a);var s={depth:r,bevelEnabled:!0,bevelSegments:2,steps:2,bevelSize:0,bevelThickness:0},h=new p.e(o,s),c=new p.i({color:15658734}),d=new p.h(h,c);return d.position.x=-i/2,d.position.z=-n/2,d.rotation.x=g,d}({size:{width:f,height:v}}),O=new p.g;O.add(z,M),t(O)},a.onerror=function(){return r()}}))},r=function(t){var e=t.size,n=t.position,r=t.rotation,a=t.exhibits,s=e.width,h=e.height,c=e.depth,d=new p.d(s,h,c),u=new p.i({color:14540253}),w=new p.h(d,u);w.position.y=c/2,w.position.z=h/2,w.rotation.x=-g;var l=new p.h(new p.d(s+.2,c+.2,1),new p.i({color:6710886}));l.position.y=c/2,l.position.z=.5;var f=new p.g;f.add(w,l),Object.assign(f.position,n),Object.assign(f.rotation,r);var v=s/a.length,x=v/2;return Promise.all(a.map((function(t,e){return o({url:t,rotation:r}).then((function(t){t.position.set(-s/2+x+v*e,0,12),f.add(t)}))}))).finally((function(){i(!1)})),f},a=function(){var t=[new p.l(16777215,1,80),new p.l(16777215,1,80)];return t[0].position.set(0,-25,19),t[1].position.set(0,25,19),t}(),s=function(){var t=new p.d(100,100,1),i=new p.i({color:3355443}),n=new p.h(t,i);n.position.z=-.5;var o=d.polygon([[[-49,-49],[49,-49],[49,49],[-49,49],[-49,-49]]]);return n.onClick=function(t){var i=t.point,n=i.x,r=i.y;if(d.booleanPointInPolygon(d.point([n,r]),o)){var a=10*Math.sqrt(Math.pow(e.position.x-n,2)+Math.pow(e.position.y-r,2));new u.a.Tween(e.position).to({x:n,y:r},a).interpolation(u.a.Interpolation.Bezier).easing(u.a.Easing.Linear.None).start()}},n}(),c=function(){var t=new p.d(100,100,1),e=new p.i({color:16777215}),i=new p.h(t,e);return i.position.z=20.5,i}(),f=[{size:{width:100,height:20,depth:1},position:{x:0,y:50,z:0},rotation:{x:0,y:0,z:0},exhibits:["./exhibits/1-1.jpg","./exhibits/1-2.jpg","./exhibits/1-4.jpg","./exhibits/1-5.jpg"]},{size:{width:100,height:20,depth:1},position:{x:0,y:-50,z:0},rotation:{x:0,y:0,z:b},exhibits:["./exhibits/2-1.jpg","./exhibits/2-2.jpg","./exhibits/2-4.jpg","./exhibits/2-5.jpg"]},{size:{width:50,height:20,depth:1},position:{x:-50,y:25,z:0},rotation:{x:0,y:0,z:g},exhibits:["./exhibits/3-1.jpg"]},{size:{width:50,height:20,depth:1},position:{x:-50,y:-25,z:0},rotation:{x:0,y:0,z:g},exhibits:["./exhibits/3-5.jpg"]},{size:{width:30,height:20,depth:1},position:{x:-35,y:-.5,z:0},rotation:{x:0,y:0,z:0},exhibits:["./exhibits/3-2.jpg"]},{size:{width:30,height:20,depth:1},position:{x:-35,y:.5,z:0},rotation:{x:0,y:0,z:b},exhibits:["./exhibits/3-4.jpg"]},{size:{width:50,height:20,depth:1},position:{x:50,y:25,z:0},rotation:{x:0,y:0,z:-g},exhibits:["./exhibits/4-1.jpg"]},{size:{width:50,height:20,depth:1},position:{x:50,y:-25,z:0},rotation:{x:0,y:0,z:-g},exhibits:["./exhibits/4-5.jpg"]},{size:{width:30,height:20,depth:1},position:{x:35,y:-.5,z:0},rotation:{x:0,y:0,z:0},exhibits:["./exhibits/4-2.jpg"]},{size:{width:30,height:20,depth:1},position:{x:35,y:.5,z:0},rotation:{x:0,y:0,z:b},exhibits:["./exhibits/4-4.jpg"]}].map(r);return e.position.set(0,-30,12),e.rotation.set(g,0,0),{geometries:[].concat(Object(h.a)(a),[s,c],Object(h.a)(f)),boundaries:[d.polygon([[[-49,-49],[49,-49],[49,-2],[19,-2],[19,2],[49,2],[49,49],[-49,49],[-49,2],[-19,2],[-19,-2],[-49,-2],[-49,-49]]])]}}},O=function(){var t=Object(n.useRef)(),e=Object(n.useState)(!1),i=Object(c.a)(e,2),o=i[0],r=i[1],a=Object(n.useReducer)((function(t,e){return Object(s.a)(Object(s.a)({},t),e)}),{}),d=Object(c.a)(a,2),w=d[0],l=w.scene,b=w.camera,y=w.renderer,j=d[1],m=Object(n.useState)(!0),O=Object(c.a)(m,2),E=O[0],L=O[1],k=Object(n.useState)(1),A=Object(c.a)(k,2),T=A[0],C=A[1],P=Object(n.useRef)([]),I=Object(n.useState)(""),q=Object(c.a)(I,2),S=q[0],Y=q[1];return Object(n.useEffect)((function(){if(!o){var e=function(t){var e=t.offsetWidth,i=t.offsetHeight,n=new p.n,o=new p.k(75,e/i,.1,1e3);o.position.set(0,0,12),o.rotation.set(g,0,0);var r=new p.r({antialias:!0});return r.setSize(e,i),r.setClearColor(2238530,1),t.appendChild(r.domElement),window.scene=n,window.camera=o,window.renderer=r,{scene:n,camera:o,renderer:r}}(t.current);r(!0),j(e),function(t){var e=t.scene,i=new p.a(16777215,.5);e.add(i)}(e),z(e,P),function(t){var e=t.scene,i=t.camera,n=t.renderer.domElement;n.addEventListener("pointerdown",(function(t){var o=t.offsetX,r=t.offsetY,a=Date.now();n.addEventListener("pointerup",(function t(s){n.removeEventListener("pointerup",t);var h=s.offsetX,d=s.offsetY,u=Date.now();if(!(Math.abs(o-h)>5||Math.abs(r-d)>5||u-a>1e3)){var w=n.offsetWidth,l=n.offsetHeight,f=new p.m,v=h/w*2-1,x=-d/l*2+1,b=new p.q(v,x);f.setFromCamera(b,i);var g=f.intersectObjects(e.children,!0),y=Object(c.a)(g,1)[0];y&&y.object&&y.object.onClick&&y.object.onClick(y)}}))}))}(e)}}),[o]),Object(n.useEffect)((function(){if(b&&y){var e=function(){var e=t.current,i=e.offsetWidth,n=e.offsetHeight;b.aspect=i/n,b.updateProjectionMatrix(),y.setSize(i,n)};return window.addEventListener("resize",e),function(){window.removeEventListener("resize",e)}}}),[b,y]),Object(n.useEffect)((function(){if(l&&b&&y){var t=M[T];if(t){L(!0);var e=t({scene:l,camera:b,renderer:y,setLoading:L,setCurrentExhibit:Y}),i=e.geometries,n=e.boundaries;return l.add.apply(l,Object(h.a)(i)),P.current=n,function(){l.remove.apply(l,Object(h.a)(i)),P.current=[]}}}}),[l,b,y,T]),Object(n.useEffect)((function(){if(l&&b&&y){var t=!1;return function e(){t||(requestAnimationFrame(e),u.a.update(),y.render(l,b))}(),function(){return t=!0}}}),[l,b,y]),Object(n.useEffect)((function(){var t=function(t){"Escape"===t.key&&Y("")};return document.addEventListener("keydown",t),function(){document.removeEventListener("keydown",t)}}),[]),Object(x.jsxs)(f.a,{spinning:E,style:{width:"100vw",height:"100vh"},children:[Object(x.jsx)("div",{ref:t,style:{width:"100vw",height:"100vh",touchAction:"none"}}),Object(x.jsx)("div",{style:{position:"absolute",top:0,right:0,padding:20},children:Object(x.jsxs)(v.a.Group,{children:[Object(x.jsx)(v.a,{type:1===T?"primary":"",onClick:function(){return C(1)},children:"\u4e00\u697c"}),Object(x.jsx)(v.a,{type:2===T?"primary":"",onClick:function(){return C(2)},children:"\u4e8c\u697c"})]})}),S?Object(x.jsx)("div",{style:{display:S?"":"none",position:"fixed",top:0,left:0,width:"100vw",height:"100vh",textAlign:"center",background:"#000",userSelect:"none"},onClick:function(){return Y("")},children:Object(x.jsx)("img",{alt:"",src:S,style:{maxWidth:"100%",maxHeight:"100%"}})}):null]})};a.a.render(Object(x.jsx)(o.a.StrictMode,{children:Object(x.jsx)(O,{})}),document.getElementById("root"))}},[[82,1,2]]]);
//# sourceMappingURL=main.a5fc674e.chunk.js.map